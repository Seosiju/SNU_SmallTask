# Task(11) ProbTutor - 확률 개념 설명 및 시각화 챗봇

## 📋 프로젝트 개요

OpenAI Assistants API와 Code Interpreter를 활용하여 대학교 1학년 수준의 확률 개념을 설명하고, 관련 문제를 해결하며, 시각화를 제공하는 대화형 확률 튜터 챗봇 시스템입니다.

### 주요 기능
- **확률 개념 설명**: 베이즈 정리, 조건부 확률, 확률 분포 등 핵심 개념 설명
- **문제 해결**: Code Interpreter를 통한 정확한 수치 계산 및 해결 과정 제시
- **시각화**: matplotlib을 활용한 확률 분포, 차트, 그래프 자동 생성
- **대화형 학습**: 사용자 수준에 맞춘 친절한 튜터 역할

### 기술 스택
- **OpenAI Assistants API**: 대화 처리 및 Code Interpreter 활용
- **Python**: 확률 계산 및 시각화
- **matplotlib**: 그래프 및 차트 생성
- **python-dotenv**: 환경 변수 관리

## 🚀 설치 및 설정

### 1. 필수 패키지 설치

```bash
pip install openai python-dotenv matplotlib numpy scipy
```

### 2. 환경 변수 설정

`.env` 파일을 생성하고 OpenAI API 키를 설정:

```env
OPENAI_API_KEY=your_openai_api_key_here
```

### 3. 실행 방법

Jupyter Notebook에서 `task(11).ipynb` 파일을 열고 셀을 순차적으로 실행하세요.

## 💻 사용 방법

### 기본 사용법

```python
# 대화형 튜터 시작
chat_with_probtutor()

# 확률 문제 해결 테스트
test_probability_calculation()

# 시각화 테스트
test_visualization()
```

### 대화 흐름

1. **인사 및 주제 추천**: 확률 관련 주제들을 추천
2. **사용자 질문**: 확률 개념이나 문제에 대한 질문
3. **개념 설명**: 정의, 공식, 구성 요소, 예시 제공
4. **문제 해결**: Code Interpreter를 통한 정확한 계산
5. **시각화**: 관련 그래프나 차트 자동 생성
6. **맥락 유지**: 이전 대화 내용을 기억하며 자연스러운 대화

## 🎯 핵심 기능

### 확률 개념 설명
- **정의**: 수학적 정의를 명확하게 설명
- **공식**: 관련 수학 공식 제시
- **구성 요소**: 공식의 각 부분 설명
- **구체적 예시**: 실제 상황을 통한 이해도 향상

### 문제 해결 (Code Interpreter)
- **Python 코드 자동 실행**: 확률 계산을 위한 코드 생성
- **정확한 수치 계산**: 복잡한 확률 문제의 정확한 해
- **해결 과정 제시**: 단계별 계산 과정 설명
- **결과 자동 출력**: 계산 결과를 명확하게 표시

### 시각화
- **확률 분포**: 정규분포, 이항분포, 포아송분포 등
- **차트**: 막대그래프, 파이차트, 히스토그램
- **그래프**: 확률 밀도 함수, 누적 분포 함수
- **이미지 자동 표시**: 생성된 시각화를 노트북에서 바로 확인

## 🔧 주요 함수

### 핵심 함수들

- `create_probability_assistant()`: 확률 튜터 Assistant 생성
- `send_message_to_assistant(message)`: Assistant에게 메시지 전송
- `display_assistant_response(response)`: Assistant 응답 표시 (텍스트 + 이미지)
- `chat_with_probtutor()`: 메인 대화 루프

### 테스트 함수들

- `test_assistant_creation()`: Assistant 생성 테스트
- `test_probability_calculation()`: 확률 계산 테스트
- `test_visualization()`: 시각화 생성 테스트
- `run_comprehensive_test()`: 종합 테스트 실행

### 유틸리티 함수들

- `validate_user_input(input_text)`: 사용자 입력 검증
- `handle_assistant_error(error)`: Assistant 오류 처리
- `format_probability_explanation(concept)`: 확률 개념 설명 포맷팅

## 🧪 테스트 케이스

### 확률 개념 설명 테스트
- "베이즈 정리란 무엇인가요?"
- "조건부 확률을 설명해주세요"
- "정규분포의 특징은 무엇인가요?"

### 문제 해결 테스트
- "동전을 3번 던져서 앞면이 2번 나올 확률을 계산해주세요"
- "주사위를 2개 던져서 합이 7이 될 확률을 구해주세요"
- "P(A|B) = 0.3, P(B) = 0.4일 때 P(A∩B)를 구해주세요"

### 시각화 테스트
- "정규분포 그래프를 그려주세요"
- "이항분포의 확률 질량 함수를 보여주세요"
- "베이즈 정리를 시각화해주세요"

## 📊 시스템 아키텍처

```
사용자 질문 → 입력 검증 → Assistant API 호출
     ↓           ↓            ↓
  유효성 확인   형식 검사    Code Interpreter
     ↓           ↓            ↓
  오류 메시지   재입력 요청   Python 코드 실행
     ↓           ↓            ↓
  대화 종료    사용자 피드백   수치 계산 + 시각화
     ↓           ↓            ↓
  종료/재시도   대화 계속     결과 표시 (텍스트 + 이미지)
```

### 상세 아키텍처

```
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   사용자 입력    │───▶│   입력 검증      │───▶│  Assistant API  │
│  (확률 질문)     │    │  (길이, 형식)    │    │  (GPT-4 + Code) │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   오류 처리     │    │   재입력 요청    │    │  Code 실행      │
│  (잘못된 입력)  │    │  (구체화 요청)   │    │  (Python 코드)  │
└─────────────────┘    └──────────────────┘    └─────────────────┘
         │                       │                       │
         ▼                       ▼                       ▼
┌─────────────────┐    ┌──────────────────┐    ┌─────────────────┐
│   대화 종료     │    │   대화 계속      │    │  결과 생성      │
│   또는 재시도   │    │   (맥락 유지)   │    │  (텍스트+이미지)│
└─────────────────┘    └──────────────────┘    └─────────────────┘
```

## 📋 평가 기준

이 프로젝트는 다음 5가지 기준으로 평가됩니다:

1. **🎯 Design Requirements 충족**: 확률 개념 설명, 문제 해결, 시각화 기능
2. **🧮 수학적 정확성**: Code Interpreter를 통한 정확한 계산
3. **📊 시각화 품질**: matplotlib을 활용한 명확한 그래프 생성
4. **💬 대화 자연스러움**: 확률 튜터로서의 친절하고 교육적인 톤
5. **🔧 코드 완성도**: 기능적 일관성, 에러 처리, 사용자 경험

## 🔍 사용 예시

### 예시 1: 확률 개념 설명
```
사용자: 베이즈 정리가 무엇인가요?
ProbTutor: 베이즈 정리는 조건부 확률을 계산하는 중요한 공식입니다.

정의: P(A|B) = P(B|A) × P(A) / P(B)

구성 요소:
- P(A|B): 사후 확률 (Posterior)
- P(B|A): 가능도 (Likelihood)  
- P(A): 사전 확률 (Prior)
- P(B): 증거 (Evidence)

예시: 의학 진단에서 사용되는 베이즈 정리를 시각화해드릴게요.
[matplotlib 그래프 생성]
```

### 예시 2: 문제 해결
```
사용자: 동전을 3번 던져서 앞면이 2번 나올 확률을 계산해주세요
ProbTutor: 이항분포를 사용해서 계산해드릴게요.

P(X=2) = C(3,2) × (0.5)² × (0.5)¹ = 3 × 0.25 × 0.5 = 0.375

[Python 코드 실행 결과 표시]
[이항분포 그래프 생성]
```

### 예시 3: 시각화 요청
```
사용자: 정규분포 그래프를 그려주세요
ProbTutor: 정규분포의 확률 밀도 함수를 그려드릴게요.

[정규분포 그래프 생성]
정규분포는 평균을 중심으로 대칭인 종 모양의 분포입니다.
```

## ⚙️ 설정 옵션

### Assistant 설정
```python
ASSISTANT_NAME = "ProbTutor"
ASSISTANT_INSTRUCTIONS = """
당신은 대학교 1학년 수준의 확률 개념을 설명하는 친절한 튜터입니다.
- 확률 개념을 명확하게 설명하세요
- Code Interpreter를 활용해 정확한 계산을 수행하세요
- matplotlib으로 시각화를 생성하세요
- 친절하고 교육적인 톤을 유지하세요
"""
```

### 전역 설정
```python
MAX_CONVERSATION_LENGTH = 50    # 최대 대화 길이
DEFAULT_TEMPERATURE = 0.7       # 창의성 설정
ENABLE_VISUALIZATION = True      # 시각화 활성화
```

## 🛡️ 에러 처리

### API 오류 처리
- Rate limit 초과: "API 사용량이 초과되었습니다. 잠시 후 다시 시도해주세요."
- 인증 오류: "API 인증에 문제가 있습니다. API 키를 확인해주세요."
- Assistant 오류: "Assistant 처리 중 오류가 발생했습니다. 다시 시도해주세요."

### 입력 검증
- 빈 입력: "확률 관련 질문을 입력해주세요."
- 너무 짧은 입력: "좀 더 구체적인 질문을 해주세요."
- 수학적 오류: "계산 중 오류가 발생했습니다. 다른 방법으로 시도해보겠습니다."

## 📈 성능 특징

- **정확한 계산**: Code Interpreter를 통한 수치적 정확성
- **즉시 시각화**: matplotlib을 활용한 실시간 그래프 생성
- **맥락 유지**: 대화 히스토리를 통한 자연스러운 대화
- **교육적 접근**: 단계별 설명과 예시를 통한 이해도 향상
- **사용자 친화적**: 직관적이고 친근한 인터페이스

## 📝 주의사항

1. **API 키 보안**: `.env` 파일을 `.gitignore`에 추가하여 버전 관리에서 제외
2. **API 사용량**: OpenAI API 사용량에 따른 비용 발생 가능
3. **수학적 정확성**: 복잡한 확률 문제의 경우 계산 과정을 단계별로 확인
4. **시각화 품질**: matplotlib 설정에 따라 그래프 품질이 달라질 수 있음

## 🚧 향후 개선 사항

- [ ] 고급 확률 분포 지원 (감마분포, 베타분포 등)
- [ ] 통계적 가설검정 기능 추가
- [ ] 확률 시뮬레이션 (몬테카를로 방법)
- [ ] 대화 히스토리 저장 및 불러오기
- [ ] 음성 입력/출력 지원
- [ ] 웹 인터페이스 개발

## 📚 참고 자료

- [OpenAI Assistants API Documentation](https://platform.openai.com/docs/assistants/overview)
- [matplotlib Documentation](https://matplotlib.org/stable/index.html)
- [확률론 교재 및 온라인 자료](https://www.khanacademy.org/math/statistics-probability)
- [Cursor Rules for ProbTutor](/.cursor/rules/rules.mdc)

---

**💬 확률 학습에 도움이 필요하시면 언제든 ProbTutor에게 질문해주세요!**
